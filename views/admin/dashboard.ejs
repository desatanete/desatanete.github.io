<%- include('../partials/head', { title: 'Admin' }) %>
<section class="max-w-6xl mx-auto px-6 py-10">
  <h1 class="text-3xl font-bold mb-6">Admin Dashboard</h1>

  <div class="grid md:grid-cols-2 gap-8">
    <div>
      <h2 class="text-xl font-semibold mb-3">Tambah Berita</h2>
      <form method="post" action="/admin/berita" class="space-y-3">
        <div>
          <label class="block text-sm font-medium">Judul</label>
          <input name="judul" required class="mt-1 w-full border rounded px-3 py-2" />
        </div>
        <div>
          <label class="block text-sm font-medium">URL Gambar (opsional)</label>
          <input name="gambar" class="mt-1 w-full border rounded px-3 py-2" />
        </div>
        <div>
          <label class="block text-sm font-medium">Isi</label>
          <textarea name="isi" rows="6" required class="mt-1 w-full border rounded px-3 py-2"></textarea>
        </div>
        <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Simpan</button>
      </form>

      <h2 class="text-xl font-semibold mt-10 mb-3">Daftar Berita</h2>
      <div class="space-y-3">
        <% if (news.length === 0) { %>
          <p class="text-gray-600">Belum ada berita.</p>
        <% } %>
        <% news.forEach(n => { %>
          <div class="bg-white rounded-xl shadow p-4">
            <div class="font-semibold"><a href="/berita/<%= n.slug %>" class="hover:text-blue-600"><%= n.judul %></a></div>
            <div class="text-sm text-gray-500"><%= new Date(n.createdAt).toLocaleString('id-ID') %></div>
          </div>
        <% }) %>
      </div>
    </div>

    <div>
      <h2 class="text-xl font-semibold mb-3">Pengaduan Masuk</h2>
      <div class="space-y-3">
        <% if (complaints.length === 0) { %>
          <p class="text-gray-600">Belum ada pengaduan.</p>
        <% } %>
        <% complaints.forEach(c => { %>
          <div class="bg-white rounded-xl shadow p-4">
            <div class="flex items-center justify-between">
              <div class="font-semibold"><%= c.nama %> <span class="text-xs text-gray-500">(<%= c.kategori %>)</span></div>
              <span class="text-xs px-2 py-1 rounded-full <%= c.status === 'selesai' ? 'bg-emerald-100 text-emerald-700' : c.status === 'diproses' ? 'bg-amber-100 text-amber-700' : 'bg-gray-100 text-gray-700' %>"><%= c.status %></span>
            </div>
            <div class="text-sm text-gray-500 mb-2"><%= new Date(c.createdAt).toLocaleString('id-ID') %> | <%= c.kontak || '-' %></div>
            <p class="text-gray-800 whitespace-pre-line"><%= c.isi %></p>
            <form class="mt-3" method="post" action="/admin/pengaduan/<%= c.id %>/status">
              <select name="status" class="border rounded px-2 py-1">
                <option value="baru" <%= c.status === 'baru' ? 'selected' : '' %>>Baru</option>
                <option value="diproses" <%= c.status === 'diproses' ? 'selected' : '' %>>Diproses</option>
                <option value="selesai" <%= c.status === 'selesai' ? 'selected' : '' %>>Selesai</option>
              </select>
              <button class="ml-2 px-3 py-1 bg-blue-600 text-white rounded">Ubah</button>
            </form>
          </div>
        <% }) %>
      </div>
    </div>
  </div>
</section>
<%- include('../partials/footer') %>